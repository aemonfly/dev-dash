"use strict";$(document).ready(function(){RepoSelect.init(),Greet.init(),HitApi.init(),RenderTable.init()});var HitApi=function(){function e(){l.$inputForm=$("#input-form")}function t(){l.$inputForm.submit(r)}function n(e){return{type:e.type,date:a(e.created_at),actor:e.actor.display_login,avatar:e.actor.avatar_url,payload:e.payload}}function a(e){return new Date(e).toDateString().slice(0,15).replace(/ 0/g," ")}function r(e){e.preventDefault();var t={url:"https://api.github.com/repos",user:e.currentTarget[0].value,repo:e.currentTarget[1].value,route:"events"},n=t.url+"/"+t.user+"/"+t.repo+"/"+t.route;$.getJSON(n).then(o)}function o(e){var t=["PushEvent","CommitCommentEvent"],a=["IssuesEvent","IssueCommentEvent","ProjectEvent","ProjectCardEvent","ProjectColumnEvent"],r=["CreateEvent","PullRequestEvent","PullRequestReviewEvent","PullRequestReviewCommentEvent"],o=e.filter(function(e){return t.indexOf(e.type)!==-1}).map(n),p=e.filter(function(e){return a.indexOf(e.type)!==-1}).map(n),l=e.filter(function(e){return r.indexOf(e.type)!==-1}).map(n);RenderTable.render(o,p,l)}function p(){e(),t()}var l={};return{init:p}}(),Greet=function(){function e(){var e=Math.floor(Math.random()*r.length);return r[e]}function t(){var e,t,n=new Date,a=n.getHours();return t=LS.getData("momentum-settings")&&void 0!==LS.getData("momentum-settings").userName?LS.getData("momentum-settings").userName:o,e=a<12?"Morning":a>=12&&a<17?"Afternoon":"Evening","Good "+e+", "+t+"."}function n(){$("#greeting").text(t())}function a(){n()}var r=["pal","sexy","cool guy","dork","classy"],o=e();return{init:a}}(),LS=function(){function e(e,t){r&&r.setItem(e,JSON.stringify(t))}function t(e){if(r)return JSON.parse(r.getItem(e))}function n(){if(r)return r.clear()}function a(e){if(r)return r.removeItem(e)}var r=function(){var e,t,n=(new Date).toString();try{return e=window.localStorage,e.setItem(n,n),t=e.getItem(n)===n,e.removeItem(n),t&&e}catch(e){console.log("Problemz!")}}();return{setData:e,getData:t,deleteData:a,clearData:n}}(),RenderTable=function(){function e(){p.$container=$(".table-container")}function t(e,t,o){p.$container.empty(),e.length>0&&n(e),t.length>0&&a(t),o.length>0&&r(o)}function n(e){var t=$(document.createElement("div")),n=$(document.createElement("ul"));e.forEach(function(e){if("PushEvent"===e.type)e.payload.commits.forEach(function(t){var a=$(document.createElement("li")),r=$(document.createElement("img")),o=$(document.createElement("p")),p=$(document.createElement("span")),l=$(document.createElement("a")),c=t.url.replace(/\/\/api./,"//").replace(/\/repos\//,"/").replace(/commits/,"commit");r.attr("src",e.avatar),l.attr("target","_blank").attr("href",c).html('<span class="bolder">'+t.sha.slice(0,6)+"</span>"),p.text('"'+t.message+'"'),o.append('<span class="bolder">'+e.actor+"</span> committed ").append(l).append(" on "+e.date+": ").append(p),a.append(r).append(o),n.append(a)});else{var t=$(document.createElement("li")),a=$(document.createElement("img")),r=$(document.createElement("p")),o=$(document.createElement("span")),p=$(document.createElement("a"));a.attr("src",e.avatar),p.attr("target","_blank").attr("href",e.payload.comment.html_url).html('<span class="bolder">'+e.payload.comment.commit_id.slice(0,6)+"</span>"),o.text('"'+e.payload.comment.body+'"'),r.append('<span class="bolder">'+e.actor+"</span> commented on ").append(p).append(" on "+e.date+": ").append(o),t.append(a).append(r),n.append(t)}}),n.addClass("col-list"),t.addClass("col-1of3").append("<h3>"+e.length+" Commit-Related Events</h3>").append(n),p.$container.append(t)}function a(e){var t=$(document.createElement("div")),n=$(document.createElement("ul"));e.forEach(function(e){var t=$(document.createElement("li")),a=$(document.createElement("img")),r=$(document.createElement("p")),o=$(document.createElement("a"));a.attr("src",e.avatar),o.attr("target","_blank"),"IssuesEvent"===e.type?(o.attr("href",e.payload.issue.html_url).html('<span class="bolder">issue '+e.payload.issue.number+"</span>"),r.append('<span class="bolder">'+e.actor+"</span> "+e.payload.action+" ").append(o).append(" on "+e.date+': "'+e.payload.issue.title+'"'),t.append(a).append(r),n.append(t)):"IssueCommentEvent"===e.type&&(o.attr("href",e.payload.comment.html_url).html('<span class="bolder">issue '+e.payload.issue.number+"</span>"),r.append('<span class="bolder">'+e.actor+"</span> commented on ").append(o).append(" on "+e.date+': "'+e.payload.comment.body+'"'),t.append(a).append(r),n.append(t))}),n.addClass("col-list"),t.addClass("col-1of3").append("<h3>"+e.length+" Todo-Related Events</h3>").append(n),p.$container.append(t)}function r(e){var t,n=$(document.createElement("div")),a=$(document.createElement("ul"));e.forEach(function(e){var n=$(document.createElement("li")),r=$(document.createElement("img")),o=$(document.createElement("p")),p=$(document.createElement("a"));r.attr("src",e.avatar),p.attr("target","_blank"),"CreateEvent"===e.type?(o.append(['<span class="bolder">'+e.actor+"</span>","created",e.payload.ref_type,'<span class="bolder">'+e.payload.ref+"</span>","on",e.date].join(" ")),n.append(r).append(o),a.append(n)):"PullRequestEvent"===e.type?(t=e.payload.pull_request.url.replace(/\/\/api./,"//").replace(/\/repos\//,"/").replace(/pulls/,"pull"),p.attr("href",t).html('<span class="bolder">pull request '+e.payload.pull_request.number+"</span>"),o.append('<span class="bolder">'+e.actor+"</span>").append(" "+e.payload.action+" ").append(p).append(" on "+e.date),n.append(r).append(o),a.append(n)):"PullRequestReviewEvent"===e.type?(p.attr("href",e.payload.pull_request.html_url).text(e.payload.pull_request.title),o.append([e.actor,e.payload.action,"review of "].join(" ")).append(p).append(" on"+e.date),n.append(r).append(o),a.append(n)):"PullRequestReviewCommentEvent"===e.type&&(p.attr("href",e.payload.comment.html_url).text(e.payload.comment.body),o.append(['<span class="bolder">'+e.actor+"</span>",e.payload.action,"pull request comment "].join(" ")).append(p).append(" on"+e.date),n.append(r).append(o),a.append(n))}),a.addClass("col-list"),n.addClass("col-1of3").append("<h3>"+e.length+" Merge-Related Events</h3>").append(a),p.$container.append(n)}function o(){e()}var p={};return{init:o,render:t}}(),RepoSelect=function(){function e(){p.$selectContainer=$("#repo-select"),p.$selector=$(document.createElement("span")),p.$listContainer=$(document.createElement("div")),p.$repoList=$(document.createElement("ul"))}function t(){p.$selector.on("click",a)}function n(){var e=["dev-dash","meerkat_momentum"];LS.getData("dev-dash")&&LS.getData("dev-dash").repos&&LS.getData("dev-dash").repos.forEach(function(t){e.push(t)}),0===e.length?p.$repoList.append("<li>Add some repos, yo!</li>"):e.forEach(function(e){var t=$(document.createElement("a"));t.attr("href","#").text(e),p.$repoList.append("<li>"+t+"</li>")}),p.$listContainer.append(p.$repoList)}function a(e){e.preventDefault(),p.$selectContainer.append(p.$listContainer),p.$listContainer.toggleClass("hidden"),console.log(e)}function r(){console.log(p.$selector),p.$listContainer.addClass("repo-list").addClass("hidden"),p.$selector.addClass("repo-select").html("dev-dash &#x25BC;"),p.$selectContainer.append("You are currently viewing ").append(p.$selector).append(" repository.")}function o(){e(),n(),t(),r()}var p={};return{init:o}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImdldC1ldmVudHMuanMiLCJncmVldC5qcyIsImxvY2FsX3N0b3JhZ2UuanMiLCJyZW5kZXItdGFibGUuanMiLCJyZXBvLXNlbGVjdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIlJlcG9TZWxlY3QiLCJpbml0IiwiR3JlZXQiLCJIaXRBcGkiLCJSZW5kZXJUYWJsZSIsImNhY2hlRG9tIiwiRE9NIiwiJGlucHV0Rm9ybSIsImJpbmRFdmVudHMiLCJzdWJtaXQiLCJnZXRFdmVudHMiLCJwcmVwYXJlRXZlbnRzIiwiZSIsInR5cGUiLCJkYXRlIiwiZm9ybWF0RGF0ZXMiLCJjcmVhdGVkX2F0IiwiYWN0b3IiLCJkaXNwbGF5X2xvZ2luIiwiYXZhdGFyIiwiYXZhdGFyX3VybCIsInBheWxvYWQiLCJEYXRlIiwidG9EYXRlU3RyaW5nIiwic2xpY2UiLCJyZXBsYWNlIiwicHJldmVudERlZmF1bHQiLCJhcGkiLCJ1cmwiLCJ1c2VyIiwiY3VycmVudFRhcmdldCIsInZhbHVlIiwicmVwbyIsInJvdXRlIiwicmVwb0V2ZW50cyIsImdldEpTT04iLCJ0aGVuIiwiaGFuZGxlUmVzcG9uc2UiLCJyZXNwb25zZSIsImNvbW1pdFR5cGVzIiwidG9kb1R5cGVzIiwibWVyZ2VUeXBlcyIsImNvbW1pdEV2ZW50cyIsImZpbHRlciIsImluZGV4T2YiLCJtYXAiLCJ0b2RvRXZlbnRzIiwibWVyZ2VFdmVudHMiLCJyZW5kZXIiLCJzZWxlY3ROYW1lIiwiaW5kIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZGVmYXVsdE5hbWVzIiwibGVuZ3RoIiwiZ2V0TWVzc2FnZSIsInRpbWVPZkRheSIsInVzZXJOYW1lIiwidGVoRGF0ZSIsImluaXRpYWxIb3VyIiwiZ2V0SG91cnMiLCJMUyIsImdldERhdGEiLCJ1bmRlZmluZWQiLCJkdW1teSIsImRpc3BsYXlNZXNzYWdlIiwidGV4dCIsInNldERhdGEiLCJsb2MiLCJ2YWwiLCJzdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXJzZSIsImdldEl0ZW0iLCJjbGVhckRhdGEiLCJjbGVhciIsImRlbGV0ZURhdGEiLCJyZW1vdmVJdGVtIiwicmVzdWx0IiwidWlkIiwidG9TdHJpbmciLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJleGNlcHRpb24iLCJjb25zb2xlIiwibG9nIiwiJGNvbnRhaW5lciIsImVtcHR5IiwicmVuZGVyQ29tbWl0RXZlbnRzIiwicmVuZGVyVG9kb0V2ZW50cyIsInJlbmRlck1lcmdlRXZlbnRzIiwiZXMiLCIkY29sdW1uIiwiY3JlYXRlRWxlbWVudCIsIiRsaXN0IiwiZm9yRWFjaCIsImV2dCIsImNvbW1pdHMiLCJjb21taXQiLCIkbGlzdEl0ZW0iLCIkaW1nIiwiJHBhcmFncmFwaCIsIiRwYXJhU3BhbiIsIiRhIiwiY2xlYW5VcmwiLCJhdHRyIiwiaHRtbCIsInNoYSIsIm1lc3NhZ2UiLCJhcHBlbmQiLCJjb21tZW50IiwiaHRtbF91cmwiLCJjb21taXRfaWQiLCJib2R5IiwiYWRkQ2xhc3MiLCJpc3N1ZSIsIm51bWJlciIsImFjdGlvbiIsInRpdGxlIiwicmVmX3R5cGUiLCJyZWYiLCJqb2luIiwicHVsbF9yZXF1ZXN0IiwiJHNlbGVjdENvbnRhaW5lciIsIiRzZWxlY3RvciIsIiRsaXN0Q29udGFpbmVyIiwiJHJlcG9MaXN0Iiwib24iLCJzaG93UmVwb0xpc3QiLCJidWlsZFJlcG9MaXN0IiwicmVwb3MiLCJwdXNoIiwiJGFuY2hvciIsInRvZ2dsZUNsYXNzIl0sIm1hcHBpbmdzIjoiWUFLQUEsR0FBQUMsVUFBQUMsTUFBQSxXQUlBQyxXQUFBQyxPQUVBQyxNQUFBRCxPQUVBRSxPQUFBRixPQUVBRyxZQUFBSCxRQ1pBLElBQUFFLFFBQUEsV0FNQSxRQUFBRSxLQUNBQyxFQUFBQyxXQUFBVixFQUFBLGVBS0EsUUFBQVcsS0FDQUYsRUFBQUMsV0FBQUUsT0FBQUMsR0FLQSxRQUFBQyxHQUFBQyxHQUNBLE9BQ0FDLEtBQUFELEVBQUFDLEtBQ0FDLEtBQUFD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aUJBQ0FkLE9BQUExRyxFQUFBMEgsZ0JBRUExSCxFQUFBMEgsZUFDQVEsWUFBQSxVQUVBakQsUUFBQUMsSUFBQTVFLEdBS0EsUUFBQW9DLEtBRUF1QyxRQUFBQyxJQUFBbEYsRUFBQXlILFdBRUF6SCxFQUFBMEgsZUFDQVgsU0FBQSxhQUNBQSxTQUFBLFVBRUEvRyxFQUFBeUgsVUFDQVYsU0FBQSxlQUNBUixLQUFBLHFCQUVBdkcsRUFBQXdILGlCQUNBZCxPQUFBLDhCQUNBQSxPQUFBMUcsRUFBQXlILFdBQ0FmLE9BQUEsZ0JBS0EsUUFBQS9HLEtBQ0FJLElBQ0ErSCxJQUNBNUgsSUFDQXdDLElBakdBLEdBQUExQyxLQXNHQSxRQUNBTCxLQUFBQSIsImZpbGUiOiJkZXYtZGFzaC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xuLyogZ2xvYmFscyAkLCBkb2N1bWVudCwgY29uc29sZSAqL1xuXG4vKiBhcHAuanMgY2FsbCBlYWNoIG1vZHVsZSdzIHB1YmxpYyBtZXRob2QocykgICovXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICBcbiAgICAvLyBCYWNrZ3JvdW5kcy5pbml0KCk7ICAvLyB0b2RvXG4gICAgXG4gICAgUmVwb1NlbGVjdC5pbml0KCk7XG4gICAgXG4gICAgR3JlZXQuaW5pdCgpO1xuICAgIFxuICAgIEhpdEFwaS5pbml0KCk7XG4gICAgXG4gICAgUmVuZGVyVGFibGUuaW5pdCgpO1xuXG4gICAgLy8gUmVuZGVyR3JhcGgucmVuZGVyKCk7ICAvLyB0b2RvXG5cbn0pOyIsIi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xuLyogZ2xvYmFscyAkLCBkb2N1bWVudCwgY29uc29sZSwgUmVuZGVyVGFibGUgKi9cblxudmFyIEhpdEFwaSA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgRE9NID0ge307XG4gICAgXG4gICAgXG4gICAgLy8gY2FjaGUgRE9NIGVsZW1lbnRzXG4gICAgZnVuY3Rpb24gY2FjaGVEb20oKSB7XG4gICAgICAgIERPTS4kaW5wdXRGb3JtID0gJCgnI2lucHV0LWZvcm0nKTtcbiAgICB9XG4gICAgXG5cbiAgICAvLyBiaW5kIGV2ZW50c1xuICAgIGZ1bmN0aW9uIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIERPTS4kaW5wdXRGb3JtLnN1Ym1pdChnZXRFdmVudHMpO1xuICAgIH1cblxuXG4gICAgLy8gcHJlcGFyZSBldmVudHMgcHJpb3IgdG8gY2FsbGluZyByZW5kZXJlcnNcbiAgICBmdW5jdGlvbiBwcmVwYXJlRXZlbnRzKGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGUgICAgOiBlLnR5cGUsXG4gICAgICAgICAgICBkYXRlICAgIDogZm9ybWF0RGF0ZXMoZS5jcmVhdGVkX2F0KSxcbiAgICAgICAgICAgIGFjdG9yICAgOiBlLmFjdG9yLmRpc3BsYXlfbG9naW4sXG4gICAgICAgICAgICBhdmF0YXIgIDogZS5hY3Rvci5hdmF0YXJfdXJsLFxuICAgICAgICAgICAgcGF5bG9hZCA6IGUucGF5bG9hZFxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLy8gZm9ybWF0IGRhdGVzXG4gICAgZnVuY3Rpb24gZm9ybWF0RGF0ZXMoZGF0ZSkge1xuXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlKSAgICAgLy8gbWFrZSBkYXRlIG9iamVjdCBmb3IgZGF5ICYgbW9udGggYWJicmV2XG4gICAgICAgICAgICAudG9EYXRlU3RyaW5nKCkgICAgICAgLy8gY29udmVydCBvYmplY3QgdG8gYSBzdHJpbmdcbiAgICAgICAgICAgIC5zbGljZSgwLCAxNSkgICAgICAgICAvLyByZW1vdmUgZXZlcnl0aGluZyBhZnRlciB0aGUgWVlZWVxuICAgICAgICAgICAgLnJlcGxhY2UoLyAwL2csICcgJyk7IC8vIHJlbW92ZSBsZWFkaW5nIHplcm9zIChleC4gJzA0JyA9PiAnNCcpXG4gICAgfVxuXG4gICAgXG4gICAgLy8gZ2V0IGdpdGh1YiBldmVudHNcbiAgICBmdW5jdGlvbiBnZXRFdmVudHMoZSkge1xuICAgICAgICBcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHZhciBhcGkgPSB7XG4gICAgICAgICAgICB1cmwgICA6ICdodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zJyxcbiAgICAgICAgICAgIHVzZXIgIDogZS5jdXJyZW50VGFyZ2V0WzBdLnZhbHVlLFxuICAgICAgICAgICAgcmVwbyAgOiBlLmN1cnJlbnRUYXJnZXRbMV0udmFsdWUsXG4gICAgICAgICAgICByb3V0ZSA6ICdldmVudHMnXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXBvRXZlbnRzID0gYCR7YXBpLnVybH0vJHthcGkudXNlcn0vJHthcGkucmVwb30vJHthcGkucm91dGV9YDtcblxuICAgICAgICAkLmdldEpTT04ocmVwb0V2ZW50cykudGhlbihoYW5kbGVSZXNwb25zZSk7XG4gICAgfVxuXG5cbiAgICAvLyBoYW5kbGUgR0ggSlNPTiByZXNwb25zZSBkYXRhXG4gICAgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpIHtcblxuICAgICAgICAvLyB3ZSdyZSBzcGxpdHRpbmcgZXZlbnRzIGludG8gMyBjYXRlZ29yaWVzLCBiYXNlZCBvbiBldmVudCB0eXBlXG4gICAgICAgIHZhciBjb21taXRUeXBlcyA9IFsnUHVzaEV2ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb21taXRDb21tZW50RXZlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRvZG9UeXBlcyA9IFsnSXNzdWVzRXZlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICdJc3N1ZUNvbW1lbnRFdmVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ1Byb2plY3RFdmVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ1Byb2plY3RDYXJkRXZlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICdQcm9qZWN0Q29sdW1uRXZlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBtZXJnZVR5cGVzID0gWydDcmVhdGVFdmVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdQdWxsUmVxdWVzdEV2ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ1B1bGxSZXF1ZXN0UmV2aWV3RXZlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnUHVsbFJlcXVlc3RSZXZpZXdDb21tZW50RXZlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gY3JlYXRlIGFycmF5IG9mIGNvbW1pdC1yZWxhdGVkIGV2ZW50c1xuICAgICAgICAgICAgY29tbWl0RXZlbnRzID0gcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChlKSA9PiBjb21taXRUeXBlcy5pbmRleE9mKGUudHlwZSkgIT09IC0xKVxuICAgICAgICAgICAgICAgIC5tYXAocHJlcGFyZUV2ZW50cyksXG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSBhcnJheSBvZiB0b2RvLXJlbGF0ZWQgZXZlbnRzXG4gICAgICAgICAgICB0b2RvRXZlbnRzID0gcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChlKSA9PiB0b2RvVHlwZXMuaW5kZXhPZihlLnR5cGUpICE9PSAtMSlcbiAgICAgICAgICAgICAgICAubWFwKHByZXBhcmVFdmVudHMpLFxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgYnVpbGQgYXJyYXkgb2YgbWVyZ2UtcmVsYXRlZCBldmVudHNcbiAgICAgICAgICAgIG1lcmdlRXZlbnRzID0gcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChlKSA9PiBtZXJnZVR5cGVzLmluZGV4T2YoZS50eXBlKSAhPT0gLTEpXG4gICAgICAgICAgICAgICAgLm1hcChwcmVwYXJlRXZlbnRzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIGNhbGwgcmVuZGVyZXJzXG4gICAgICAgIFJlbmRlclRhYmxlLnJlbmRlcihjb21taXRFdmVudHMsIHRvZG9FdmVudHMsIG1lcmdlRXZlbnRzKTtcbiAgICAgICAgLy8gUmVuZGVyR3JhcGgucmVuZGVyKGNvbW1pdEV2ZW50cywgdG9kb0V2ZW50cywgbWVyZ2VFdmVudHMpOyAgLy8gdG8gZG9cbiAgICB9XG4gICAgXG4gICAgXG4gICAgLy8gcHVibGljIGluaXQgbWV0aG9kXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgY2FjaGVEb20oKTtcbiAgICAgICAgYmluZEV2ZW50cygpO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyByZXR1cm4gcHVibGljIG1ldGhvZFxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGluaXRcbiAgICB9O1xuXG59KCkpO1xuIiwiLyoganNoaW50IGVzdmVyc2lvbjo2ICovXG4vKiBnbG9iYWxzICQsIGNvbnNvbGUsIExTICovXG5cbnZhciBHcmVldCA9IChmdW5jdGlvbigpIHtcbiAgICBcbiAgICAvLyBpbml0IHZhcnNcbiAgICB2YXIgZGVmYXVsdE5hbWVzID0gW1xuICAgICAgICAgICAgJ3BhbCcsXG4gICAgICAgICAgICAnc2V4eScsXG4gICAgICAgICAgICAnY29vbCBndXknLFxuICAgICAgICAgICAgJ2RvcmsnLFxuICAgICAgICAgICAgJ2NsYXNzeSdcbiAgICAgICAgXSxcbiAgICAgICAgZHVtbXkgPSBzZWxlY3ROYW1lKCk7XG4gICAgXG4gICAgXG4gICAgLy8gcGljayBhIG5hbWUgZnJvbSBkZWZhdWx0c1xuICAgIGZ1bmN0aW9uIHNlbGVjdE5hbWUoKSB7XG4gICAgICAgIHZhciBpbmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBkZWZhdWx0TmFtZXMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHROYW1lc1tpbmRdO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBhc2lnbiB0aW1lLWJhc2VkIG1lc3NhZ2UgdG8gJ2dyZWV0JyBvbiBpbml0aWFsIGxvYWRcbiAgICBmdW5jdGlvbiBnZXRNZXNzYWdlKCkge1xuICAgICAgICB2YXIgdGltZU9mRGF5LFxuICAgICAgICAgICAgdGVoRGF0ZSA9IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBpbml0aWFsSG91ciA9IHRlaERhdGUuZ2V0SG91cnMoKSxcbiAgICAgICAgICAgIHVzZXJOYW1lO1xuICAgICAgICBcbiAgICAgICAgLy8gY2hlY2sgZm9yIGxvY2FsIHN0b3JhZ2UgJiB3aGV0aGVyIHVzZXJOYW1lIGlzIHVuZGVmaW5lZCBcbiAgICAgICAgaWYgKExTLmdldERhdGEoJ21vbWVudHVtLXNldHRpbmdzJykgJiYgTFMuZ2V0RGF0YSgnbW9tZW50dW0tc2V0dGluZ3MnKS51c2VyTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB1c2VyTmFtZSA9IExTLmdldERhdGEoJ21vbWVudHVtLXNldHRpbmdzJykudXNlck5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyTmFtZSA9IGR1bW15O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoaW5pdGlhbEhvdXIgPCAxMikge1xuICAgICAgICAgICAgdGltZU9mRGF5ID0gXCJNb3JuaW5nXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5pdGlhbEhvdXIgPj0gMTIgJiYgaW5pdGlhbEhvdXIgPCAxNykge1xuICAgICAgICAgICAgdGltZU9mRGF5ID0gXCJBZnRlcm5vb25cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRpbWVPZkRheSA9IFwiRXZlbmluZ1wiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGBHb29kICR7dGltZU9mRGF5fSwgJHt1c2VyTmFtZX0uYDtcbiAgICB9XG4gICAgXG5cbiAgICAvLyByZW5kZXIgbWVzc2FnZSB0byBET01cbiAgICBmdW5jdGlvbiBkaXNwbGF5TWVzc2FnZSgpIHtcbiAgICAgICAgJCgnI2dyZWV0aW5nJykudGV4dChnZXRNZXNzYWdlKCkpO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBwdWJsaWMgaW5pdCBtZXRob2RcbiAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBkaXNwbGF5TWVzc2FnZSgpO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBleHBvcnQgcHVibGljIG1ldGhvZHNcbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0OiBpbml0XG4gICAgfTtcbiAgICBcbn0oKSk7XG4iLCIvKiBqc2hpbnQgZXN2ZXJzaW9uOjYgKi9cbi8qIGdsb2JhbHMgd2luZG93ICovXG5cbnZhciBMUyA9IChmdW5jdGlvbigpIHtcblxuICAgLyoqIFxuICAgICogbG9jYWxTdG9yYWdlIGZlYXR1cmUgZGV0ZWN0ICYgcmV0dXJuIGxvY2FsIHJlZmVyZW5jZVxuICAgICogQHBhcmFtICAgICAgIFtub25lXVxuICAgICogQHJldHVybnMgICAgIFtCT09MRUFOXSAgIFtyZXR1cm5zIHRydWUgaWYgc3RvcmVkIHN0cmluZyA9PT0gdWlkXVxuICAgICovXG4gICB2YXIgc3RvcmFnZSA9IChmdW5jdGlvbigpIHtcbiAgICAgIHZhciB1aWQgPSBuZXcgRGF0ZSgpLnRvU3RyaW5nKCksIC8vIGRhdGUgbXVzdCBiZSBhIHN0cmluZ1xuICAgICAgICAgc3RvcmFnZSxcbiAgICAgICAgIHJlc3VsdDtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgIHN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICAgICAgICAgc3RvcmFnZS5zZXRJdGVtKHVpZCwgdWlkKTtcbiAgICAgICAgIHJlc3VsdCA9IHN0b3JhZ2UuZ2V0SXRlbSh1aWQpID09PSB1aWQ7XG4gICAgICAgICBzdG9yYWdlLnJlbW92ZUl0ZW0odWlkKTtcbiAgICAgICAgIHJldHVybiByZXN1bHQgJiYgc3RvcmFnZTtcbiAgICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9ibGVteiEnKTtcbiAgICAgIH1cbiAgIH0oKSk7XG5cbiAgIC8qKiBcbiAgICAqIFN0b3JlIGl0ZW0gaW4gbG9jYWwgc3RvcmFnZSBpZiBzdG9yYWdlIGV4aXN0c1xuICAgICogQHBhcmFtICAgICAgIFtzdHJpbmddICAgIGxvYyAgICAgICAgIFtsb2NhbCBzdG9yYWdlIHN1Yi1sb2NhdGlvbl1cbiAgICAqIEBwYXJhbSAgICAgICBbc3RyaW5nXSAgICB2YWwgICAgICAgICBbc3RyaW5nIHRvIGJlIHN0b3JlZF1cbiAgICAqIEBwYXJhbSAgICAgICBbZnVuY3Rpb25dICBzdG9yYWdlICAgICBbbG9jYWxTdG9yYWdlIGZlYXR1cmUgZGV0ZWN0ICYgbG9jYWwgcmVmXVxuICAgICovXG4gICBmdW5jdGlvbiBzZXREYXRhKGxvYywgdmFsKSB7XG4gICAgICBpZiAoc3RvcmFnZSkge1xuICAgICAgICAgc3RvcmFnZS5zZXRJdGVtKGxvYywgSlNPTi5zdHJpbmdpZnkodmFsKSk7XG4gICAgICB9XG4gICB9XG5cbiAgIC8qKiBcbiAgICAqIEdldCBsb2NhbCBzdG9yYWdlIGlmIHN0b3JhZ2UgZXhpc3RzXG4gICAgKiBAcGFyYW0gICAgICAgW3N0cmluZ10gICAgbG9jICAgICAgICAgW2xvY2FsIHN0b3JhZ2Ugc3ViLWxvY2F0aW9uXVxuICAgICogQHBhcmFtICAgICAgIFtmdW5jdGlvbl0gIHN0b3JhZ2UgICAgIFtsb2NhbFN0b3JhZ2UgZmVhdHVyZSBkZXRlY3QgJiBsb2NhbCByZWZdXG4gICAgKiBAcmV0dXJucyAgICAgW0pTT04gc3RyaW5nXSAgICAgICAgICAgW2ZldGNoIHN0b3JlZCBzdHJpbmcsIHJldHVybiBKU09OXVxuICAgICovXG4gICBmdW5jdGlvbiBnZXREYXRhKGxvYykge1xuICAgICAgaWYgKHN0b3JhZ2UpIHtcbiAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0b3JhZ2UuZ2V0SXRlbShsb2MpKTtcbiAgICAgIH1cbiAgIH1cblxuICAgLyoqIFxuICAgICogRGVsZXRlIEFMTCBrZXlzIGZyb20gbG9jYWwgc3RvcmFnZSBpZiBwYXNzXG4gICAgKiBAcGFyYW0gICAgICAgW2Z1bmN0aW9uXSAgc3RvcmFnZSAgICAgW2xvY2FsU3RvcmFnZSBmZWF0dXJlIGRldGVjdCAmIGxvY2FsIHJlZl1cbiAgICAqIEByZXR1cm5zICAgICBbZnVuY3Rpb25dICAuY2xlYXIgICAgICBbd2lwZXMgbG9jYWwgc3RvcmFnZV1cbiAgICAqL1xuICAgZnVuY3Rpb24gY2xlYXJEYXRhKCkge1xuICAgICAgaWYgKHN0b3JhZ2UpIHtcbiAgICAgICAgIHJldHVybiBzdG9yYWdlLmNsZWFyKCk7XG4gICAgICB9XG4gICB9XG5cbiAgIC8qKiBcbiAgICAqIERlbGV0ZSBPTkUga2V5IGZyb20gbG9jYWwgc3RvcmFnZSBpZiBwYXNzXG4gICAgKiBAcGFyYW0gICAgICAgW3N0cmluZ10gICAgbG9jICAgICAgICAgW3RoZSBrZXkgdG8gZGVsZXRlIGZyb20gbG9jYWxTdG9yYWdlXVxuICAgICogQHBhcmFtICAgICAgIFtmdW5jdGlvbl0gIHN0b3JhZ2UgICAgIFtsb2NhbFN0b3JhZ2UgZmVhdHVyZSBkZXRlY3QgJiBsb2NhbCByZWZdXG4gICAgKiBAcmV0dXJucyAgICAgW2Z1bmN0aW9uXSAgLmNsZWFyICAgICAgW3dpcGVzIGxvY2FsIHN0b3JhZ2VdXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGRlbGV0ZURhdGEobG9jKSB7XG4gICAgICBpZiAoc3RvcmFnZSkge1xuICAgICAgICAgcmV0dXJuIHN0b3JhZ2UucmVtb3ZlSXRlbShsb2MpO1xuICAgICAgfVxuICAgfVxuXG4gICByZXR1cm4ge1xuICAgICAgc2V0RGF0YTogc2V0RGF0YSxcbiAgICAgIGdldERhdGE6IGdldERhdGEsXG4gICAgICBkZWxldGVEYXRhOiBkZWxldGVEYXRhLFxuICAgICAgY2xlYXJEYXRhOiBjbGVhckRhdGFcbiAgIH07XG5cbn0oKSk7IiwiLyoganNoaW50IGVzdmVyc2lvbjo2ICovXG4vKiBnbG9iYWxzICQsIGRvY3VtZW50ICovXG5cbnZhciBSZW5kZXJUYWJsZSA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgRE9NID0ge307XG4gICAgXG4gICAgXG4gICAgLy8gY2FjaGUgRE9NIGVsZW1lbnRzXG4gICAgZnVuY3Rpb24gY2FjaGVEb20oKSB7XG4gICAgICAgIERPTS4kY29udGFpbmVyID0gJCgnLnRhYmxlLWNvbnRhaW5lcicpO1xuICAgIH1cbiAgICAgICAgXG5cbiAgICAvLyBwdWJsaWMgcmVuZGVyIG1ldGhvZCBjYWxscyBjYXRlZ29yeSByZW5kZXJlcnMgaWYgY2F0ZWdvcnkgaGFzIGV2ZW50c1xuICAgIGZ1bmN0aW9uIHJlbmRlcihjb21taXRFdmVudHMsIHRvZG9FdmVudHMsIG1lcmdlRXZlbnRzKSB7XG5cbiAgICAgICAgLy8gY2xlYXIgcHJldmlvdXMgcmVzdWx0c1xuICAgICAgICBET00uJGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgICAgIGlmIChjb21taXRFdmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVuZGVyQ29tbWl0RXZlbnRzKGNvbW1pdEV2ZW50cyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodG9kb0V2ZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZW5kZXJUb2RvRXZlbnRzKHRvZG9FdmVudHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lcmdlRXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlbmRlck1lcmdlRXZlbnRzKG1lcmdlRXZlbnRzKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLy8gcmVuZGVyIGNvbW1pdCBldmVudHNcbiAgICBmdW5jdGlvbiByZW5kZXJDb21taXRFdmVudHMoZXMpIHtcblxuICAgICAgICAvLyBnZXRzIFB1c2hFdmVudHMgJiBDb21taXRDb21tZW50RXZlbnRzXG5cbiAgICAgICAgdmFyICRjb2x1bW4gPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKSxcbiAgICAgICAgICAgICRsaXN0ICAgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJykpO1xuXG4gICAgICAgIGVzLmZvckVhY2goZnVuY3Rpb24gKGV2dCkge1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhldnQpO1xuXG4gICAgICAgICAgICBpZiAoZXZ0LnR5cGUgPT09ICdQdXNoRXZlbnQnKSB7XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIGl0J3MgYSBwdXNoIGV2ZW50LCBleHRyYWN0IHRoZSBjb21taXRzXG4gICAgICAgICAgICAgICAgZXZ0LnBheWxvYWQuY29tbWl0cy5mb3JFYWNoKGZ1bmN0aW9uIChjb21taXQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgJGxpc3RJdGVtICA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAkaW1nICAgICAgID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAkcGFyYWdyYXBoID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJykpLFxuICAgICAgICAgICAgICAgICAgICAgICAgJHBhcmFTcGFuICA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRhICAgICAgICAgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29udmVydCBjb21taXQgVVJMIGludG8gcmVndWxhciBnaXRodWIuY29tIFVSTFxuICAgICAgICAgICAgICAgICAgICAvLyBmcm9tOiBodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3t1c2VyfS97cmVwb30vY29tbWl0cy97c2hhfVxuICAgICAgICAgICAgICAgICAgICAvLyAgIHRvOiBodHRwczovL2dpdGh1Yi5jb20ve3VzZXJ9L3tyZXBvfS9jb21taXQve3NoYX1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsZWFuVXJsID0gKGNvbW1pdC51cmwpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgJ2FwaS4nXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwvXFwvYXBpLi8sICdcXC9cXC8nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlICdyZXBvcy8nXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwvcmVwb3NcXC8vLCAnXFwvJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgJ2NvbW1pdHMnIHdpdGggJ2NvbW1pdCdcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9jb21taXRzLywgJ2NvbW1pdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICRpbWcuYXR0cignc3JjJywgZXZ0LmF2YXRhcik7XG5cbiAgICAgICAgICAgICAgICAgICAgJGFcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgY2xlYW5VcmwpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChgPHNwYW4gY2xhc3M9XCJib2xkZXJcIj4keyhjb21taXQuc2hhKS5zbGljZSgwLDYpfTwvc3Bhbj5gKTtcblxuICAgICAgICAgICAgICAgICAgICAkcGFyYVNwYW5cbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KGBcIiR7Y29tbWl0Lm1lc3NhZ2V9XCJgKTtcblxuICAgICAgICAgICAgICAgICAgICAkcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPiR7ZXZ0LmFjdG9yfTwvc3Bhbj4gY29tbWl0dGVkIGApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChgIG9uICR7ZXZ0LmRhdGV9OiBgKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkcGFyYVNwYW4pO1xuXG4gICAgICAgICAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkaW1nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkcGFyYWdyYXBoKTtcblxuICAgICAgICAgICAgICAgICAgICAkbGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkbGlzdEl0ZW0pO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIGVsc2UgaXQncyBhIGNvbW1lbnRcblxuICAgICAgICAgICAgICAgIHZhciAkbGlzdEl0ZW0gID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpKSxcbiAgICAgICAgICAgICAgICAgICAgJGltZyAgICAgICA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJykpLFxuICAgICAgICAgICAgICAgICAgICAkcGFyYWdyYXBoID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJykpLFxuICAgICAgICAgICAgICAgICAgICAkcGFyYVNwYW4gID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpLFxuICAgICAgICAgICAgICAgICAgICAkYSAgICAgICAgID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpO1xuXG4gICAgICAgICAgICAgICAgJGltZy5hdHRyKCdzcmMnLCBldnQuYXZhdGFyKTtcblxuICAgICAgICAgICAgICAgICRhXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hyZWYnLCBldnQucGF5bG9hZC5jb21tZW50Lmh0bWxfdXJsKVxuICAgICAgICAgICAgICAgICAgICAuaHRtbChgPHNwYW4gY2xhc3M9XCJib2xkZXJcIj4keyhldnQucGF5bG9hZC5jb21tZW50LmNvbW1pdF9pZCkuc2xpY2UoMCw2KX08L3NwYW4+YCk7XG5cbiAgICAgICAgICAgICAgICAkcGFyYVNwYW5cbiAgICAgICAgICAgICAgICAgICAgLnRleHQoYFwiJHtldnQucGF5bG9hZC5jb21tZW50LmJvZHl9XCJgKTtcblxuICAgICAgICAgICAgICAgICRwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChgPHNwYW4gY2xhc3M9XCJib2xkZXJcIj4ke2V2dC5hY3Rvcn08L3NwYW4+IGNvbW1lbnRlZCBvbiBgKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRhKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGAgb24gJHtldnQuZGF0ZX06IGApXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJHBhcmFTcGFuKTtcblxuICAgICAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRpbWcpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJHBhcmFncmFwaCk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRsaXN0SXRlbSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGxpc3RcbiAgICAgICAgICAgIC5hZGRDbGFzcygnY29sLWxpc3QnKTtcblxuICAgICAgICAkY29sdW1uXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2NvbC0xb2YzJylcbiAgICAgICAgICAgIC5hcHBlbmQoYDxoMz4ke2VzLmxlbmd0aH0gQ29tbWl0LVJlbGF0ZWQgRXZlbnRzPC9oMz5gKVxuICAgICAgICAgICAgLmFwcGVuZCgkbGlzdCk7XG5cbiAgICAgICAgRE9NLiRjb250YWluZXIuYXBwZW5kKCRjb2x1bW4pO1xuXG4gICAgfVxuXG5cbiAgICAvLyByZW5kZXIgdG9kbyBldmVudHNcbiAgICBmdW5jdGlvbiByZW5kZXJUb2RvRXZlbnRzKGVzKSB7XG5cbiAgICAgICAgLy8gZ2V0cyBJc3N1ZXNFdmVudHMsIElzc3VlQ29tbWVudEV2ZW50cywgUHJvamVjdEV2ZW50cyxcbiAgICAgICAgLy8gICBQcm9qZWN0Q2FyZEV2ZW50cywgYW5kIFByb2plY3RDb2x1bW5FdmVudHNcblxuICAgICAgICB2YXIgJGNvbHVtbiA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpLFxuICAgICAgICAgICAgJGxpc3QgICA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKSk7XG5cbiAgICAgICAgZXMuZm9yRWFjaChmdW5jdGlvbiAoZXZ0KSB7XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGV2dCk7XG5cbiAgICAgICAgICAgIHZhciAkbGlzdEl0ZW0gID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpKSxcbiAgICAgICAgICAgICAgICAkaW1nICAgICAgID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKSksXG4gICAgICAgICAgICAgICAgJHBhcmFncmFwaCA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpKSxcbiAgICAgICAgICAgICAgICAkYSAgICAgICAgID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpO1xuXG4gICAgICAgICAgICAkaW1nLmF0dHIoJ3NyYycsIGV2dC5hdmF0YXIpO1xuXG4gICAgICAgICAgICAkYS5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJyk7XG5cbiAgICAgICAgICAgIGlmIChldnQudHlwZSA9PT0gJ0lzc3Vlc0V2ZW50Jykge1xuXG4gICAgICAgICAgICAgICAgJGFcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hyZWYnLCBldnQucGF5bG9hZC5pc3N1ZS5odG1sX3VybClcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoYDxzcGFuIGNsYXNzPVwiYm9sZGVyXCI+aXNzdWUgJHtldnQucGF5bG9hZC5pc3N1ZS5udW1iZXJ9PC9zcGFuPmApO1xuXG4gICAgICAgICAgICAgICAgJHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPiR7ZXZ0LmFjdG9yfTwvc3Bhbj4gJHtldnQucGF5bG9hZC5hY3Rpb259IGApXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJGEpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoYCBvbiAke2V2dC5kYXRlfTogXCIke2V2dC5wYXlsb2FkLmlzc3VlLnRpdGxlfVwiYCk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdEl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkaW1nKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRwYXJhZ3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgJGxpc3RcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkbGlzdEl0ZW0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2dC50eXBlID09PSAnSXNzdWVDb21tZW50RXZlbnQnKSB7XG5cbiAgICAgICAgICAgICAgICAkYVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaHJlZicsIGV2dC5wYXlsb2FkLmNvbW1lbnQuaHRtbF91cmwpXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPmlzc3VlICR7ZXZ0LnBheWxvYWQuaXNzdWUubnVtYmVyfTwvc3Bhbj5gKTtcblxuICAgICAgICAgICAgICAgICRwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChgPHNwYW4gY2xhc3M9XCJib2xkZXJcIj4ke2V2dC5hY3Rvcn08L3NwYW4+IGNvbW1lbnRlZCBvbiBgKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRhKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGAgb24gJHtldnQuZGF0ZX06IFwiJHtldnQucGF5bG9hZC5jb21tZW50LmJvZHl9XCJgKTtcblxuICAgICAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRpbWcpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJHBhcmFncmFwaCk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRsaXN0SXRlbSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vICAgICAgICAgICAgLy8gQ0FOJ1QgR0VUIEdIIFRPIFNFTkQgVVMgUFJPSkVDVC1SRUxBVEVEIEVWRU5UUyAtIFdURj9cbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIGlmIChldnQudHlwZSA9PT0gJ1Byb2plY3RFdmVudCcpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgJGxpc3RcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGA8bGk+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke2V2dC5hdmF0YXJ9XCI+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+JHtldnQuYWN0b3J9ICR7ZXZ0LnBheWxvYWQuYWN0aW9ufSAke2V2dC5wYXlsb2FkLnByb2plY3QubmFtZX0gb24gJHtldnQuZGF0ZX08L3A+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cIiR7ZXZ0LnBheWxvYWQucHJvamVjdC51cmx9XCI+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7ZXZ0LnBheWxvYWQucHJvamVjdC5ib2R5fVxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+YCk7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfSBlbHNlIGlmIChldnQudHlwZSA9PT0gJ1Byb2plY3RDYXJkRXZlbnQnKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRsaXN0XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChgPGxpPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtldnQuYXZhdGFyfVwiPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPiR7ZXZ0LmFjdG9yfSAke2V2dC5wYXlsb2FkLmFjdGlvbn0gXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cIiR7ZXZ0LnBheWxvYWQucHJvamVjdF9jYXJkLnVybH1cIj5cbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtldnQucGF5bG9hZC5wcm9qZWN0X2NhcmQubm90ZX1cbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb24gJHtldnQuZGF0ZX08L3A+XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPmApO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LnR5cGUgPT09ICdQcm9qZWN0Q29sdW1uRXZlbnQnKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICRsaXN0XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChgPGxpPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtldnQuYXZhdGFyfVwiPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPiR7ZXZ0LmFjdG9yfSAke2V2dC5wYXlsb2FkLmFjdGlvbn0gXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cIiR7ZXZ0LnBheWxvYWQucHJvamVjdF9jb2x1bW4udXJsfVwiPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2V2dC5wYXlsb2FkLnByb2plY3RfY29sdW1uLm5hbWV9XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uICR7ZXZ0LmRhdGV9PC9wPlxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5gKTtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRsaXN0XG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2NvbC1saXN0Jyk7XG5cbiAgICAgICAgJGNvbHVtblxuICAgICAgICAgICAgLmFkZENsYXNzKCdjb2wtMW9mMycpXG4gICAgICAgICAgICAuYXBwZW5kKGA8aDM+JHtlcy5sZW5ndGh9IFRvZG8tUmVsYXRlZCBFdmVudHM8L2gzPmApXG4gICAgICAgICAgICAuYXBwZW5kKCRsaXN0KTtcblxuICAgICAgICBET00uJGNvbnRhaW5lci5hcHBlbmQoJGNvbHVtbik7XG5cbiAgICB9XG5cblxuICAgIC8vIHJlbmRlciBtZXJnZSBldmVudHNcbiAgICBmdW5jdGlvbiByZW5kZXJNZXJnZUV2ZW50cyhlcykge1xuXG4gICAgICAgIC8vIGdldHMgQ3JlYXRlRXZlbnQsIFB1bGxSZXF1ZXN0RXZlbnQsIFB1bGxSZXF1ZXN0UmV2aWV3RXZlbnRcbiAgICAgICAgLy8gICBhbmQgUHVsbFJlcXVlc3RSZXZpZXdDb21tZW50RXZlbnRcblxuICAgICAgICB2YXIgJGNvbHVtbiA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpLFxuICAgICAgICAgICAgJGxpc3QgICA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKSksXG4gICAgICAgICAgICBjbGVhblVybDtcblxuICAgICAgICBlcy5mb3JFYWNoKGZ1bmN0aW9uIChldnQpIHtcblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZXZ0KTtcblxuICAgICAgICAgICAgdmFyICRsaXN0SXRlbSAgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJykpLFxuICAgICAgICAgICAgICAgICRpbWcgICAgICAgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpKSxcbiAgICAgICAgICAgICAgICAkcGFyYWdyYXBoID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJykpLFxuICAgICAgICAgICAgICAgICRhICAgICAgICAgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSk7XG5cbiAgICAgICAgICAgICRpbWcuYXR0cignc3JjJywgZXZ0LmF2YXRhcik7XG5cbiAgICAgICAgICAgICRhLmF0dHIoJ3RhcmdldCcsICdfYmxhbmsnKTtcblxuICAgICAgICAgICAgaWYgKGV2dC50eXBlID09PSAnQ3JlYXRlRXZlbnQnKSB7XG5cbiAgICAgICAgICAgICAgICAkcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoW1xuICAgICAgICAgICAgICAgICAgICAgICAgYDxzcGFuIGNsYXNzPVwiYm9sZGVyXCI+JHtldnQuYWN0b3J9PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBldnQucGF5bG9hZC5yZWZfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPiR7ZXZ0LnBheWxvYWQucmVmfTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ29uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5kYXRlXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbignICcpKTtcblxuICAgICAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRpbWcpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJHBhcmFncmFwaCk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRsaXN0SXRlbSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LnR5cGUgPT09ICdQdWxsUmVxdWVzdEV2ZW50Jykge1xuXG4gICAgICAgICAgICAgICAgLy8gZnJvbTogaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9iZWxjdXJ2L21lZXJrYXRfbW9tZW50dW0vcHVsbHMvMTFcbiAgICAgICAgICAgICAgICAvLyAgIHRvOiBodHRwczovL2dpdGh1Yi5jb20vYmVsY3Vydi9tZWVya2F0X21vbWVudHVtL3B1bGwvMTFcblxuICAgICAgICAgICAgICAgIGNsZWFuVXJsID0gKGV2dC5wYXlsb2FkLnB1bGxfcmVxdWVzdC51cmwpXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSAnYXBpLidcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcL1xcL2FwaS4vLCAnXFwvXFwvJylcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlICdyZXBvcy8nXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXC9yZXBvc1xcLy8sICdcXC8nKVxuICAgICAgICAgICAgICAgICAgICAvLyByZXBsYWNlICdwdWxscycgd2l0aCAncHVsbCdcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3B1bGxzLywgJ3B1bGwnKTtcblxuICAgICAgICAgICAgICAgICRhXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgY2xlYW5VcmwpXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPnB1bGwgcmVxdWVzdCAke2V2dC5wYXlsb2FkLnB1bGxfcmVxdWVzdC5udW1iZXJ9PC9zcGFuPmApO1xuXG4gICAgICAgICAgICAgICAgJHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGA8c3BhbiBjbGFzcz1cImJvbGRlclwiPiR7ZXZ0LmFjdG9yfTwvc3Bhbj5gKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGAgJHtldnQucGF5bG9hZC5hY3Rpb259IGApXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJGEpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoYCBvbiAke2V2dC5kYXRlfWApO1xuXG4gICAgICAgICAgICAgICAgJGxpc3RJdGVtXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJGltZylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkcGFyYWdyYXBoKTtcblxuICAgICAgICAgICAgICAgICRsaXN0XG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJGxpc3RJdGVtKTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChldnQudHlwZSA9PT0gJ1B1bGxSZXF1ZXN0UmV2aWV3RXZlbnQnKSB7XG5cbiAgICAgICAgICAgICAgICAkYVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaHJlZicsIGV2dC5wYXlsb2FkLnB1bGxfcmVxdWVzdC5odG1sX3VybClcbiAgICAgICAgICAgICAgICAgICAgLnRleHQoZXZ0LnBheWxvYWQucHVsbF9yZXF1ZXN0LnRpdGxlKTtcblxuICAgICAgICAgICAgICAgICRwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChbXG4gICAgICAgICAgICAgICAgICAgICAgICBldnQuYWN0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBldnQucGF5bG9hZC5hY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAncmV2aWV3IG9mICdcbiAgICAgICAgICAgICAgICAgICAgXS5qb2luKCcgJykpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJGEpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJyBvbicgKyBldnQuZGF0ZSk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdEl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkaW1nKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRwYXJhZ3JhcGgpO1xuXG4gICAgICAgICAgICAgICAgJGxpc3RcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkbGlzdEl0ZW0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2dC50eXBlID09PSAnUHVsbFJlcXVlc3RSZXZpZXdDb21tZW50RXZlbnQnKSB7XG5cbiAgICAgICAgICAgICAgICAkYVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignaHJlZicsIGV2dC5wYXlsb2FkLmNvbW1lbnQuaHRtbF91cmwpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KGV2dC5wYXlsb2FkLmNvbW1lbnQuYm9keSk7XG5cbiAgICAgICAgICAgICAgICAkcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoW1xuICAgICAgICAgICAgICAgICAgICAgICAgYDxzcGFuIGNsYXNzPVwiYm9sZGVyXCI+JHtldnQuYWN0b3J9PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgICAgICBldnQucGF5bG9hZC5hY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAncHVsbCByZXF1ZXN0IGNvbW1lbnQgJ1xuICAgICAgICAgICAgICAgICAgICBdLmpvaW4oJyAnKSlcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkYSlcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnIG9uJyArIGV2dC5kYXRlKTtcblxuICAgICAgICAgICAgICAgICRsaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRpbWcpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJHBhcmFncmFwaCk7XG5cbiAgICAgICAgICAgICAgICAkbGlzdFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCRsaXN0SXRlbSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGxpc3RcbiAgICAgICAgICAgIC5hZGRDbGFzcygnY29sLWxpc3QnKTtcblxuICAgICAgICAkY29sdW1uXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2NvbC0xb2YzJylcbiAgICAgICAgICAgIC5hcHBlbmQoYDxoMz4ke2VzLmxlbmd0aH0gTWVyZ2UtUmVsYXRlZCBFdmVudHM8L2gzPmApXG4gICAgICAgICAgICAuYXBwZW5kKCRsaXN0KTtcblxuICAgICAgICBET00uJGNvbnRhaW5lci5hcHBlbmQoJGNvbHVtbik7XG5cbiAgICB9XG4gICAgXG4gICAgXG4gICAgLy8gcHVibGljIGluaXQgbWV0aG9kXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgY2FjaGVEb20oKTtcbiAgICB9XG5cblxuICAgIC8vIHJldHVybiBwdWJsaWMgbWV0aG9kXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdDogaW5pdCxcbiAgICAgICAgcmVuZGVyOiByZW5kZXJcbiAgICB9O1xuXG59KCkpOyIsIi8qIGpzaGludCBlc3ZlcnNpb246NiAqL1xuLyogZ2xvYmFscyAkLCBkb2N1bWVudCwgY29uc29sZSwgTFMgKi9cblxuLy8gR29hbDogXCJZb3UgYXJlIGN1cnJlbnRseSB2aWV3aW5nIHtSZXBvTmFtZX0gXFwvIHJlcG9zaXRvcnkuXCJcblxudmFyIFJlcG9TZWxlY3QgPSAoZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIERPTSA9IHt9O1xuICAgIFxuICAgIFxuICAgIC8vIGNhY2hlIERPTSBlbGVtZW50c1xuICAgIGZ1bmN0aW9uIGNhY2hlRG9tKCkge1xuICAgICAgICBET00uJHNlbGVjdENvbnRhaW5lciA9ICQoJyNyZXBvLXNlbGVjdCcpO1xuICAgICAgICBET00uJHNlbGVjdG9yID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpO1xuICAgICAgICBET00uJGxpc3RDb250YWluZXIgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKTtcbiAgICAgICAgRE9NLiRyZXBvTGlzdCA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKSk7XG4gICAgfVxuICAgIFxuICAgIFxuICAgIC8vIGJpbmQgZXZlbnRzXG4gICAgZnVuY3Rpb24gYmluZEV2ZW50cygpIHtcbiAgICAgICAgRE9NLiRzZWxlY3Rvci5vbignY2xpY2snLCBzaG93UmVwb0xpc3QpO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBidWlsZCByZXBvIGxpc3QgZnJvbSBsb2NhbCBzdG9yYWdlXG4gICAgZnVuY3Rpb24gYnVpbGRSZXBvTGlzdCgpIHtcbiAgICAgICAgXG4vLyAgICAgICAgdmFyIHJlcG9zID0gW107XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVwb3MgPSBbXG4gICAgICAgICAgICAnZGV2LWRhc2gnLFxuICAgICAgICAgICAgJ21lZXJrYXRfbW9tZW50dW0nXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICBpZiAoTFMuZ2V0RGF0YSgnZGV2LWRhc2gnKSAmJiBMUy5nZXREYXRhKCdkZXYtZGFzaCcpLnJlcG9zKSB7XG4gICAgICAgICAgICBMUy5nZXREYXRhKCdkZXYtZGFzaCcpLnJlcG9zLmZvckVhY2goZnVuY3Rpb24gKHJlcG8pIHtcbiAgICAgICAgICAgICAgIHJlcG9zLnB1c2gocmVwbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHJlcG9zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgRE9NLiRyZXBvTGlzdFxuICAgICAgICAgICAgICAgIC5hcHBlbmQoYDxsaT5BZGQgc29tZSByZXBvcywgeW8hPC9saT5gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcG9zLmZvckVhY2goZnVuY3Rpb24gKHJlcG8pIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGFuY2hvciA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkYW5jaG9yXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgJyMnKVxuICAgICAgICAgICAgICAgICAgICAudGV4dChyZXBvKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBET00uJHJlcG9MaXN0XG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoYDxsaT4keyRhbmNob3J9PC9saT5gKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBET00uJGxpc3RDb250YWluZXJcbiAgICAgICAgICAgIC5hcHBlbmQoRE9NLiRyZXBvTGlzdCk7XG4gICAgICAgIFxuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBzaG93L2hpZGUgcmVwbyBsaXN0XG4gICAgZnVuY3Rpb24gc2hvd1JlcG9MaXN0KGUpIHtcbiAgICAgICAgXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgXG4gICAgICAgIERPTS4kc2VsZWN0Q29udGFpbmVyXG4gICAgICAgICAgICAuYXBwZW5kKERPTS4kbGlzdENvbnRhaW5lcik7XG4gICAgICAgIFxuICAgICAgICBET00uJGxpc3RDb250YWluZXJcbiAgICAgICAgICAgIC50b2dnbGVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICB9XG4gICAgXG4gICAgXG4gICAgLy8gcmVuZGVyXG4gICAgZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coRE9NLiRzZWxlY3Rvcik7XG4gICAgICAgIFxuICAgICAgICBET00uJGxpc3RDb250YWluZXJcbiAgICAgICAgICAgIC5hZGRDbGFzcygncmVwby1saXN0JylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIFxuICAgICAgICBET00uJHNlbGVjdG9yXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ3JlcG8tc2VsZWN0JylcbiAgICAgICAgICAgIC5odG1sKCdkZXYtZGFzaCAmI3gyNUJDOycpO1xuICAgICAgICBcbiAgICAgICAgRE9NLiRzZWxlY3RDb250YWluZXJcbiAgICAgICAgICAgIC5hcHBlbmQoJ1lvdSBhcmUgY3VycmVudGx5IHZpZXdpbmcgJylcbiAgICAgICAgICAgIC5hcHBlbmQoRE9NLiRzZWxlY3RvcilcbiAgICAgICAgICAgIC5hcHBlbmQoJyByZXBvc2l0b3J5LicpO1xuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBwdWJsaWMgaW5pdCBtZXRob2RcbiAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBjYWNoZURvbSgpO1xuICAgICAgICBidWlsZFJlcG9MaXN0KCk7XG4gICAgICAgIGJpbmRFdmVudHMoKTtcbiAgICAgICAgcmVuZGVyKCk7XG4gICAgfVxuICAgIFxuICAgIFxuICAgIC8vIGV4cG9ydCBwdWJsaWMgbWV0aG9kc1xuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGluaXRcbiAgICB9O1xuICAgIFxufSgpKTtcbiJdfQ==
